<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Domotics-Base: Mqtt Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Domotics-Base
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="class_mqtt-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Mqtt Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>Base class for MQTT communication.  
 <a href="class_mqtt.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="mqtt_2mqtt_8h_source.html">mqtt.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a82438f266387890118c104dd474286d1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mqtt.html#a82438f266387890118c104dd474286d1">publishOnTopic</a> (const char *topic, const char *payload)</td></tr>
<tr class="separator:a82438f266387890118c104dd474286d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf93355dee32608181f4474a759e9773"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mqtt.html#aaf93355dee32608181f4474a759e9773">subscribeToTopic</a> (const char *topic)</td></tr>
<tr class="separator:aaf93355dee32608181f4474a759e9773"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c0ce306b95e77b2f3fcfbac9438e56f"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mqtt.html#a3c0ce306b95e77b2f3fcfbac9438e56f">connect</a> (const IPAddress &amp;brokerIp)=0</td></tr>
<tr class="separator:a3c0ce306b95e77b2f3fcfbac9438e56f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae33f44a8645be730332d5c0e4b295717"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mqtt.html#ae33f44a8645be730332d5c0e4b295717">loop</a> ()</td></tr>
<tr class="separator:ae33f44a8645be730332d5c0e4b295717"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a40040785e5f30a15ce7afb223742ce91"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mqtt.html#a40040785e5f30a15ce7afb223742ce91">connectToBroker</a> (const IPAddress &amp;brokerIp)</td></tr>
<tr class="separator:a40040785e5f30a15ce7afb223742ce91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1561b88787403d956b0c03dea1a38f61"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mqtt.html#a1561b88787403d956b0c03dea1a38f61">Mqtt</a> (const char *name, Client &amp;client)</td></tr>
<tr class="separator:a1561b88787403d956b0c03dea1a38f61"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Base class for MQTT communication. </p>
<p>This class provides the base functionality to enable MQTT communication and contains all logic to do with MQTT. All connection logic is contained within the MqttEthernet and <a class="el" href="class_mqtt_esp8266_wifi.html">MqttEsp8266Wifi</a> classes. One of these classes should be used, depending on the hardware used. To actually send/receive messages, as well as keeping the connection alive, the Mqtt::poll() methods should be called periodically</p>
<p>To enable more ways to communicate with connection hardware, for example a different ethernet controller, this class can be extended. The hardware abstraction should provide a <a href="https://www.arduino.cc/reference/en/libraries/wifi/">Client</a>. This Client is used as an interface between the hardware and the MQTT middleware. This Client has to be passed to the <a class="el" href="class_mqtt.html#a1561b88787403d956b0c03dea1a38f61">Mqtt::Mqtt(const char *, Client &amp;)</a> constructor. The Client passed to the MQTT middleware <u>CAN NOT</u> go out of scope, as a reference to this object is saved. Besides the constructor, only the <a class="el" href="class_mqtt.html#a3c0ce306b95e77b2f3fcfbac9438e56f">Mqtt::connect(const IPAddress &amp;)</a>method should be implemented. This method should connect to the broker using the chosen hardware, after which it should call <a class="el" href="class_mqtt.html#a40040785e5f30a15ce7afb223742ce91">Mqtt::connectToBroker(const IPAddress &amp;)</a>to let the base class establish the actual connection to the broker. </p>

<p class="definition">Definition at line <a class="el" href="mqtt_2mqtt_8h_source.html#l00044">44</a> of file <a class="el" href="mqtt_2mqtt_8h_source.html">mqtt.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a1561b88787403d956b0c03dea1a38f61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1561b88787403d956b0c03dea1a38f61">&#9670;&nbsp;</a></span>Mqtt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Mqtt::Mqtt </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Client &amp;&#160;</td>
          <td class="paramname"><em>client</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p><a class="el" href="class_mqtt.html" title="Base class for MQTT communication.">Mqtt</a> constructor initializing the mqtt middleware. It takes the name which is required for the mqtt broker, as well as a reference to the client to read and write data to and from the hardware. Most hardware libraries (like for a library for a specific ethernet module) will provide this client, given it's created for the Arduino ecosystem.</p>
<dl class="section note"><dt>Note</dt><dd>The client must not go out of scope, as a reference to this client is saved in the utilized mqtt library.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name of the device </td></tr>
    <tr><td class="paramname">client</td><td>The client </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a3c0ce306b95e77b2f3fcfbac9438e56f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c0ce306b95e77b2f3fcfbac9438e56f">&#9670;&nbsp;</a></span>connect()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool Mqtt::connect </td>
          <td>(</td>
          <td class="paramtype">const IPAddress &amp;&#160;</td>
          <td class="paramname"><em>brokerIp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Connect to the broker using the specified broker IP address. If connecting to the broker succeeds, this function will return true. If not, it will return false.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">brokerIp</td><td>The broker IP address</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if successful, false otherwise </dd></dl>

<p>Implemented in <a class="el" href="class_mqtt_esp8266_wifi.html#a4e5d7736f87de86ef5e6c628b958a49a">MqttEsp8266Wifi</a>, and <a class="el" href="class_mqtt_enc28_j60_ethernet.html#a0524553fd87a53c20db9c805298a10f5">MqttEnc28J60Ethernet</a>.</p>

</div>
</div>
<a id="a40040785e5f30a15ce7afb223742ce91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40040785e5f30a15ce7afb223742ce91">&#9670;&nbsp;</a></span>connectToBroker()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Mqtt::connectToBroker </td>
          <td>(</td>
          <td class="paramtype">const IPAddress &amp;&#160;</td>
          <td class="paramname"><em>brokerIp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Connect to the broker using the initialized hardware interface. If connecting to the broker succeeds, this function will return true. If not, it will return false.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">brokerIp</td><td>The broker IP address</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if successful, false otherwise </dd></dl>

</div>
</div>
<a id="ae33f44a8645be730332d5c0e4b295717"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae33f44a8645be730332d5c0e4b295717">&#9670;&nbsp;</a></span>loop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Mqtt::loop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Poll function for MQTT. Calling this function periodically is required to keep the connection alive. It's also required to receive message. If polling is successful, this function return true. If not, it will return false.</p>
<dl class="section return"><dt>Returns</dt><dd>True if successful, false otherwise </dd></dl>

</div>
</div>
<a id="a82438f266387890118c104dd474286d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82438f266387890118c104dd474286d1">&#9670;&nbsp;</a></span>publishOnTopic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Mqtt::publishOnTopic </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>payload</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Publishes a payload in a topic. As the payload is in the style of a C-style string, the payload has to be NULL terminated. If publishing the payload succeeds, this function will return true. If not, it will return false.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">topic</td><td>The topic to publish to </td></tr>
    <tr><td class="paramname">payload</td><td>The payload to publish</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if successful, false otherwise </dd></dl>

</div>
</div>
<a id="aaf93355dee32608181f4474a759e9773"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf93355dee32608181f4474a759e9773">&#9670;&nbsp;</a></span>subscribeToTopic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Mqtt::subscribeToTopic </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>topic</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Subscribes to a topic. To receive the messages, the function <a class="el" href="mqtt_2mqtt_8h.html#aaa89e9c711cd15d7868f92e3fbf0c2f3">mqttMessageReceived(const char *, const uint8_t *, uint32_t)</a> must be implemented. If subscribing to the topic succeeds, this function will return true. If not, it will return false.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">topic</td><td>The topic to subscribe to</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if successful, false otherwise </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>include/mqtt/<a class="el" href="mqtt_2mqtt_8h_source.html">mqtt.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
